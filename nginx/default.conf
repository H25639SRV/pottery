server {
  listen 80;
  server_name localhost;

  # Serve frontend build
  location / {
    root /usr/share/nginx/html;
    index index.html;
    try_files $uri $uri/ /index.html;
  }

  # ======================
  # ğŸ”„ Proxy API request tá»›i backend
  # ======================
  location /api/ {
    proxy_pass http://backend:5000;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
  }

  # ======================
  # ğŸ–¼ï¸ Render output images (backend sinh ra)
  # ======================
  location /render_output/ {
    proxy_pass http://backend:5000/render_output/;
  }

  # ======================
  # ğŸ“ Uploads (náº¿u backend cÃ³ upload file)
  # ======================
  location /uploads/ {
    proxy_pass http://backend:5000/uploads/;
  }

  # ======================
  # ğŸº Static vase images (frontend/public/render)
  # ======================
  location /render/ {
    alias /usr/share/nginx/html/render/;
    autoindex on;
  }
}
